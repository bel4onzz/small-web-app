function t(s=1,e=""){$("#users_table").html(""),$.ajax({url:"api/users?page="+s+"&search="+$("#search_table").val(),type:"GET",success:function(a){$("#users_table").html(a.table_data)},complete:function(){$("#search_table").focus(),d()}})}function o(s,e="edit"){$("#page_loader").removeClass("d-none"),$("#user_modal").html(""),$.ajax({url:"api/users/"+s+"/"+e,type:"GET",success:function(a){e==="delete"?$("#delete_user_modal").html(a.user_data):$("#user_modal").html(a.user_data)},complete:function(){e==="delete"?($("#deleteUserModal").modal("show"),$("#deleteUserModal").on("hidden.bs.modal",function(){r(s)}),u()):e==="edit"&&($("#addNewUserModal").modal("show"),$("#addNewUserModal").on("hidden.bs.modal",function(){r(s)}),n()),$("#datepicker").datepicker({format:"yyyy-mm-dd"}),$("#page_loader").addClass("d-none")}})}function d(){console.log("TABLE ACTIONS :::> "),$("#pagination_links a").on("click",function(s){s.preventDefault(),console.log("PAGINATION LINK CLICKED");var e=$(this).attr("href").split("page=")[1];t(e)}),$(".edit-user").on("click",function(s){s.preventDefault();var e=$(this).data("user-id");o(e)}),$(".delete-user-icon").on("click",function(s){s.preventDefault();var e=$(this).data("user-id");o(e,"delete")})}function n(){$(".submit-modal").unbind().on("click",function(s){s.preventDefault();var e=$("#add_new_user");e.parsley().reset(),e.parsley().validate(),e.parsley().isValid()&&$.ajax({url:e.attr("action"),type:"POST",data:new FormData(e[0]),processData:!1,contentType:!1,success:function(a){t(),e.parsley().reset(),$("#add_new_user input").val(""),$("#addNewUserModal").modal("hide"),e.attr("method")==="POST"?$("#flash_success_message").text("User created successfully!"):$("#flash_success_message").text("User updated successfully!"),$("#success_flash").addClass("show"),setTimeout(function(){$("#success_flash").removeClass("show")},2e3),$("#user_modal").html(a.modal_data)},error:function(a){for(const l in a.responseJSON.errors)$('[name="'+l+'"]').parsley()[0].addError("serverValidationError",{message:a.responseJSON.errors[l][0]})},complete:function(a){$("#datepicker").datepicker({format:"yyyy-mm-dd"})}})})}function u(){$(".delete-user-button").unbind().on("click",function(s){s.preventDefault(),$.ajax({url:"api/users/"+$(".delete-user-button").data("user-id"),type:"DELETE",processData:!1,contentType:!1,success:function(e){t(),$("#add_new_user input").val(""),$("#deleteUserModal").modal("hide"),$("#flash_success_message").text("User deleted successfully!"),$("#success_flash").addClass("show"),setTimeout(function(){$("#success_flash").removeClass("show")},2e3),$("#delete_user_modal").html(e.modal_data)}})})}function r(s){$("#add_new_user input").val(""),$.ajax({url:"api/users/"+s+"/reset-modal",type:"GET",success:function(e){$("#user_modal").html(e.user_data)},complete:function(){$("#datepicker").datepicker({format:"yyyy-mm-dd"})}})}$(function(){t(),$("#search_table").unbind().on("input",function(){var s=$(this).val().toLowerCase();typeof debounceTimer<"u"&&clearTimeout(debounceTimer),debounceTimer=setTimeout(function(){t(1,s)},1e3)})});
